@inherits TestContext

@code
{
    [Fact]
    public void MissingCallToAddIgnisReactivity()
    {
        Services.AddIgnisTestServices();
        
        var exception = Assert.Throws<InvalidOperationException>(() => RenderComponent<SilentCounter>());
        Assert.Equal("To use the Ignis reactivity system please make sure to call AddIgnisReactivity() in your Program.cs.", exception.Message);
    }
    
    [Fact]
    public void SilentCounter()
    {
        Services.AddIgnisTestServices();
        Services.AddIgnisReactivity();

        var cut = RenderComponent<SilentCounter>();
        Assert.Equal(1, cut.RenderCount);
        
        var result = cut.Find("p").TextContent;
        Assert.Equal("0", result);
        
        cut.Find("button").Click();
        
        Assert.Equal(1, cut.RenderCount);
        
        result = cut.Find("p").TextContent;
        Assert.Equal("0", result);
    }
    
    [Fact]
    public void ReactiveCounter()
    {
        Services.AddIgnisTestServices();
        Services.AddIgnisReactivity();

        var cut = RenderComponent<ReactiveCounter>();
        Assert.Equal(1, cut.RenderCount);
        
        var result = cut.Find("p").TextContent;
        Assert.Equal("0", result);
        
        cut.Find("button").Click();
        
        Assert.Equal(2, cut.RenderCount);
        
        result = cut.Find("p").TextContent;
        Assert.Equal("1", result);
    }
}